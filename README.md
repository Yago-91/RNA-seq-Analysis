# RNA-seq analysis pipeline

The script NGS_pipeline.sh is a pipeline for the analysis of RNA-seq experiments. It implementes the following steps:

**1.- SRA files automatic download  
2.- Dumping into fastq  
3.- Quality check  
4.- Fastq alignment  
5.- Transcript quantification  
6.- Differential gene expression analysis  
7.- Splicing analysis**

***1) SRA download***  
Uses *pysradb* to download detailed information of the SRP experiment to be analyzed and get the URLs corresponding to the indicated samples with *get_columns*.

***2) Dumping into fastq***  
fasterq-dump (sra-tools) to process in parallel.

***3) Quality check***  
fastqc

***4) Fastq alignment***  
The pipeline uses STAR with --quantMode set to TranscriptomeSAM for later *Salmon* step.

***5) Transcript quantification***  
*Salmon* in **alignment** mode fed with samplename_Aligned.toTranscriptome.bam generated by STAR.

***6) Differential gene expression analysis***  
Library *tximport* for *Salmon* transcript files (quant.sf) conversion into gene counts, and *DESeq2* for differential expression.

***7) Splicing analysis***  
[MAJIQ](https://majiq.biociphers.org/)





## Usage


    Required argumens:

    -g|--GTF            Path to GTF file. This file must be in
                        the same release version as the genome
                        used in aligning step.

    --gff               Path to GFF file. This file is used for
                        the MAJIQ build step.

    -o|--outdir         The directory to where save output.

    -l|--libType        Either "SINGLE" or "PAIRED" library
                        formats are accedpted.

    -p|--Nthreads       Number of parallel threads to use.
                        Default is 6.
    
    -P|--Proyect        Proyect ID: SRP...

    -I|--Index          Path to STAR genomic indexes.
  
    -X|--tx2gene        File with the correspondance of transcripts
                        and genes for tximport step.

    -G|--gene           Name of the gene for  exon-wise analysis.

    -c|--config         Configuration file.

    -R|--read-length    Read length (bp).


    
    Optional arguments:

    --remove (opt)      If used, this option drives removing of 
                        opt-type files, being opt one of these:
                        [sra|fq|sra:fq|bam|all]. Default: none.
      
    -T|--transcripts    Fasta file with transcripts of the 
                        selected species for Salmon step.

    -F|--fasta          Genome fasta file for creation of the
                        transcripts file for Salmon step.          
###                         
***Note*** : tx2gene file can be generated using [gffread](http://ccb.jhu.edu/software/stringtie/gff.shtml) tool using the following command:
    
               gffread -w /path/to/outdir/transcripts.fa -g genome.fa annotation.gtf

 
## Required packages

pysradb >=0.10  
sra-tools >=2.9.1  
STAR >=2.7  
Salmon >=0.13  
R >3.5  
Python 3  
MAJIQ 2.0  
tximport  
DESeq2




```python

```
